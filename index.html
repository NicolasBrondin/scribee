<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
    <style>
        body, html {
            background: #ecf0f1;
        }    
    </style></head>
    <body onmousemove="Game.move_element(event)" onmouseup="Game.release_element(event)" ontouchmove="Game.move_element(event)" ontouchend="Game.release_element(event)">
        <div id="buttons_container" style="height:150px;">
            <button onclick="Game.play_sound()">Ecouter la phrase</button>
        </div>
        <div id="elements_container" style="height:150px;">
            <div style="display:block;float:left; width:100px; height:120px;" id="img1" onmousedown="Game.pick_element(event)" ontouchstart="Game.pick_element(event)" data="1">   
                <img style="position: relative" src="img/aventure.png"/>
                <div style="position:relative;background: white;margin:0;padding:0;height:20px;">Un gar√ßon</div> 
            </div>
            <div style="display:block;float:left;" id="img2" onmousedown="Game.pick_element(event)" ontouchstart="Game.pick_element(event)" data="2">   <img src="img/conte.png"/> <div style="position:relative;background: white;margin:0;padding:0;height:20px;">Un robot</div> </div>
            <div style="display:block;float:left;" id="img3" onmousedown="Game.pick_element(event)" ontouchstart="Game.pick_element(event)" data="3">   <img src="img/polar.png"/> <div style="position:relative;background: white;margin:0;padding:0;height:20px;">Une fille</div>  </div>
            <div style="display:block;float:left;" id="img4" onmousedown="Game.pick_element(event)" ontouchstart="Game.pick_element(event)" data="4">   <img src="img/robot.png"/> <div style="position:relative;background: white;margin:0;padding:0;height:20px;">Une maison</div>  </div>
            </div>
        <div id="answers_container" style="height:150px;">
        <div id="div1" style="background: #bdc3c7; width:100px; height:100px;margin:5px;float:left;"></div>
        <div id="div2" style="background: #bdc3c7; width:100px; height:100px;margin:5px;float:left;"></div>
        <div id="div3" style="background: #bdc3c7; width:100px; height:100px;margin:5px;float:left;"></div>
        <div id="div4" style="background: #bdc3c7; width:100px; height:100px;margin:5px;float:left;"></div>
            </div>
        <div id="buttons_container" style="height:150px;">
            <button onclick="Game.check_answers()">Continuer</button>
        </div>
        <script type="text/javascript">
            var JS = {
    mouse: {
        move: function(e){
            var x,y;

            
            if(e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel'){
            var touch = e.touches[0] || e.changedTouches[0];
            x = touch.pageX;
            y = touch.pageY;
          } else if (e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover'|| e.type=='mouseout' || e.type=='mouseenter' || e.type=='mouseleave') {
            x = e.pageX;
            y = e.pageY;
          }

             if (x < 0){x = 0;}
             if (y < 0){y = 0;}  
            return {x:x, y:y};
        }
    },
    element: {
        move: function(element, x,y){
             element.style.position = "absolute" ;
             element.style.left = x+"px";
             element.style.top = y+"px";
        },
        get_rect: function(element){
            return {x: element.offsetLeft, y: element.offsetTop, w: element.offsetWidth, h: element.offsetHeight};
        }
    }
    
};

var Game = {
     expected_answer: [1,2,3,4],
     given_answer:[],
     selected_element: null,
     sound: new Audio('audio/voice.mp3'),
     score: 0,
     elements: [],
     answers: [],
     play_sound: function() {
          if(Game.sound){
               Game.sound.play();
          }
     },
     pick_element: function(e){

         Game.selected_element = e.target.parentElement;
         e.preventDefault();
     },
     release_element: function(e){
         if(Game.selected_element){
             //Need to check position
             console.log(Game.answers);
             var position = Game.answers.find(function(a){
                 var rect1 = JS.element.get_rect(a);
                 var rect2 = JS.element.get_rect(Game.selected_element);
                 console.log(rect1, rect2);
                 return rect2.x > rect1.x && rect2.x < (rect1.x + rect1.w) && rect2.y > rect1.y && rect2.y < (rect1.y + rect1.h);
             }.bind(this));
             console.log(position);
             if(position){
                 JS.element.move(Game.selected_element,0,0);
                 Game.selected_element.style.position = 'relative';
                 position.appendChild(Game.selected_element);
               /* Game.selected_element.style.left = JS.element.get_rect(position).x; 
                Game.selected_element.style.top = JS.element.get_rect(position).y; */
                 console.log(Game.selected_element);
             } else {
                 JS.element.move(Game.selected_element,0,0);
                 Game.selected_element.style.position = 'relative';
                 document.getElementById('elements_container').appendChild(Game.selected_element);
             }
         }
         Game.selected_element = null;
     }.bind(this),
     move_element: function(e){
          var position = JS.mouse.move(e);
          if(this.selected_element){
              JS.element.move(this.selected_element, position.x, position.y);
          }
     },
     check_answers: function(){
          if(Game.expected_answer === Game.given_answers){
              Game.score ++;
          } else {
              Game.score --;
          }
         console.log(Game.score);
     },
     init: function(){
         Game.elements = [].slice.call(document.getElementById('elements_container').children);
         Game.answers = [].slice.call(document.getElementById('answers_container').children);
     }.bind(this),
     play: function(){
     }.bind(this)
};

Game.init();
        </script>
    </body>
</html>